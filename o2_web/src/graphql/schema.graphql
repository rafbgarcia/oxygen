schema {
  query: Query
  mutation: Mutation
}

type CreateDatasetTableMutationHandler {
  dataset: Dataset
}

type Dashboard {
  id: ID!
  created: DateTime!
  modified: DateTime!
  dataset: Dataset
  name: String!
  layout: JSONString
  widgets: [Widget!]!
}

type Dataset {
  id: ID!
  created: DateTime!
  modified: DateTime!
  name: String!
  isBuilding: Boolean!
  sizeMb: Int
  lastBuiltAt: DateTime
  buildDurationSeconds: Float
  tables: [DatasetTable!]!
  dashboardSet: [Dashboard!]!
}

type DatasetTable {
  id: ID!
  dataset: Dataset!
  name: String!
  query: String!
  fields: [DatasetTableFields!]!
  totalRecords: Int
  htmlPreview: String!
}

type DatasetTableFields {
  name: String!
  type: String!
}

scalar DateTime

scalar JSONString

type Mutation {
  createDataset(name: String!): Dataset!
  buildDataset(id: ID!): Dataset!
  createDatasetTable(datasetId: ID!, name: String!, query: String!): CreateDatasetTableMutationHandler
  createDashboard(name: String!, datasetId: ID!): Dashboard!
}

type Query {
  dataset(id: ID!): Dataset!
  datasets: [Dataset!]!
  dashboards: [Dashboard!]!
}

type Widget {
  id: ID!
  created: DateTime!
  modified: DateTime!
  dashboard: Dashboard!
  title: String
  type: WidgetType!
  buildInfo: JSONString!
  gridRowIndex: Int!
}

enum WidgetType {
  PIVOT_TABLE
  LINE_CHART
  VERTICAL_BAR_CHART
}
